
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Electronice Workbook (EWB) For AuCert 2024 Workshop">
      
      
        <meta name="author" content="Greg Scheidel">
      
      
        <link rel="canonical" href="https://auscert2024.scheidel.net/a2/sec530.bonus.a2/">
      
      
        <link rel="prev" href="../../a1/sec530.bonus.a1/">
      
      
        <link rel="next" href="../../a3/sec530.bonus.a3/">
      
      
      <link rel="icon" href="../../media/tools-indigo.svg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.22">
    
    
      
        <title>Azure Environment Setup - AusCERT 2024 - Security in an (Unmanaged) Azure Environment - A Practical Example</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.732c4fb1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 9H7V7h10m0 6H7v-2h10m-3 6H7v-2h7M12 3a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m7 0h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2Z"/></svg>');--md-admonition-icon--cmd:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 10h-2V8h2m0 5h-2v-2h2m-3-1h-2V8h2m0 5h-2v-2h2m0 6H8v-2h8m-9-5H5V8h2m0 5H5v-2h2m1 0h2v2H8m0-5h2v2H8m3 1h2v2h-2m0-5h2v2h-2m9-5H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 15h6v2h-6v-2M9 7H7v2h2V7m2 6h6v-2h-6v2m0-4h6V7h-6v2m-2 2H7v2h2v-2m12-6v14c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2m-2 0H5v14h14V5M9 15H7v2h2v-2Z"/></svg>');--md-admonition-icon--reminder:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.25 3c.65 0 1.25.21 1.75.56V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.57c.5-.35 1.1-.57 1.75-.57a3 3 0 0 1 3 3c0 1.58-1.21 2.87-2.75 3h-2v1h1.24l.48.13 4.59 2.29c.82.31 1.22.92 1.22 1.83l-.03.14v.14l-1 6.75c-.06.47-.28.88-.66 1.22-.37.34-.79.5-1.26.5H10c-.55 0-1-.19-1.42-.59L2 15.84l1.05-1.07c.28-.27.64-.43 1.08-.43h.32l4.55.99V9H7a3.021 3.021 0 0 1-2.75-3 3 3 0 0 1 3-3M9 6a1.75 1.75 0 0 0-1.75-1.75A1.75 1.75 0 0 0 5.5 6c0 .88.65 1.61 1.5 1.73v.02h2V6m6 1.75v-.01c.85-.12 1.5-.85 1.5-1.74 0-.96-.78-1.74-1.75-1.74S13 5.04 13 6v1.75h2Z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#azure-environment-setup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AusCERT 2024 - Security in an (Unmanaged) Azure Environment - A Practical Example" class="md-header__button md-logo" aria-label="AusCERT 2024 - Security in an (Unmanaged) Azure Environment - A Practical Example" data-md-component="logo">
      
  <img src="../../media/tools.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AusCERT 2024 - Security in an (Unmanaged) Azure Environment - A Practical Example
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Azure Environment Setup
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../a1/sec530.bonus.a1/" class="md-tabs__link">
          
  
    
  
  Labs

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../info/" class="md-tabs__link">
        
  
    
  
  Additional Info

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../contact/" class="md-tabs__link">
        
  
    
  
  Contact Info

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AusCERT 2024 - Security in an (Unmanaged) Azure Environment - A Practical Example" class="md-nav__button md-logo" aria-label="AusCERT 2024 - Security in an (Unmanaged) Azure Environment - A Practical Example" data-md-component="logo">
      
  <img src="../../media/tools.svg" alt="logo">

    </a>
    AusCERT 2024 - Security in an (Unmanaged) Azure Environment - A Practical Example
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../a1/sec530.bonus.a1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Account Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Azure Environment Setup
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Azure Environment Setup
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Preparation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-by-step-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step-by-Step Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-start-azure-cloud-shell-session-bash" class="md-nav__link">
    <span class="md-ellipsis">
      1. Start Azure Cloud Shell Session - bash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-prepare-az-for-use" class="md-nav__link">
    <span class="md-ellipsis">
      2. Prepare az for Use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create-a-service-principal" class="md-nav__link">
    <span class="md-ellipsis">
      3. Create a Service Principal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-assign-service-principal-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      4. Assign Service Principal Permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-install-purplecloud" class="md-nav__link">
    <span class="md-ellipsis">
      5. Install PurpleCloud
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-obtain-microsoft-entra-id-domain-name" class="md-nav__link">
    <span class="md-ellipsis">
      6. Obtain Microsoft Entra ID Domain Name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-execute-purplecloud-script" class="md-nav__link">
    <span class="md-ellipsis">
      7. Execute PurpleCloud Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-set-terraform-terminal-environment" class="md-nav__link">
    <span class="md-ellipsis">
      8. Set Terraform Terminal Environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-execute-terraform" class="md-nav__link">
    <span class="md-ellipsis">
      9. Execute Terraform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../a3/sec530.bonus.a3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manual Reconnaissance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../a4/sec530.bonus.a4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Privilege Escalation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../a5/sec530.bonus.a5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Teardown
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Additional Info
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact Info
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Preparation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-by-step-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step-by-Step Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-start-azure-cloud-shell-session-bash" class="md-nav__link">
    <span class="md-ellipsis">
      1. Start Azure Cloud Shell Session - bash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-prepare-az-for-use" class="md-nav__link">
    <span class="md-ellipsis">
      2. Prepare az for Use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create-a-service-principal" class="md-nav__link">
    <span class="md-ellipsis">
      3. Create a Service Principal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-assign-service-principal-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      4. Assign Service Principal Permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-install-purplecloud" class="md-nav__link">
    <span class="md-ellipsis">
      5. Install PurpleCloud
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-obtain-microsoft-entra-id-domain-name" class="md-nav__link">
    <span class="md-ellipsis">
      6. Obtain Microsoft Entra ID Domain Name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-execute-purplecloud-script" class="md-nav__link">
    <span class="md-ellipsis">
      7. Execute PurpleCloud Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-set-terraform-terminal-environment" class="md-nav__link">
    <span class="md-ellipsis">
      8. Set Terraform Terminal Environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-execute-terraform" class="md-nav__link">
    <span class="md-ellipsis">
      9. Execute Terraform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="azure-environment-setup">Azure Environment Setup</h1>
<h2 id="objectives">Objectives</h2>
<ul>
<li>Create an Azure service principal with the permissions needed to manage your Microsoft Entra ID environment.</li>
<li>Prepare a terminal session with the variables needed to execute the Terraform client.</li>
<li>Execute a PurpleCloud script to create Terraform configuration files for your planned Microsoft Entra ID environment.</li>
<li>Execute Terraform to create the Microsoft Entra ID environment.</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Remember, your assigned task is to replicate the developers' Microsoft Entra ID environment, evaluate it for security weaknesses, and report on what you've found. Your next step - now that you have an Azure account and subscription ready to use - is to replicate Tyrell Corp's production Microsoft Entra ID environment.</p>
<p>After some hands-on investigation and discussions with some of the developers, you identified some key attributes of the production Entra ID environment:</p>
<ul>
<li>
<p>There are about a dozen Microsoft Entra ID applications and about one hundred users. The applications provide a range of services across HR, Accounting, IT operations, and other functional areas.</p>
</li>
<li>
<p>Muliple applications have an associated service principal that are granted the the Privileged Role Administrator (PRA) role, and one application has a service principal that is granted the Global Administrator role.</p>
</li>
<li>
<p>At least one user has been granted the Application Administrator role.</p>
</li>
</ul>
<p id="potential-security-issues">Several of these attributes are of concern from a security perspective!</p>
<ul>
<li>
<p>An Application Administrator holds special privileges, including the ability to manage enterprise applications and application registrations, and to reset credentials or client secrets for any application's service principal.<sup id="fnref:18"><a class="footnote-ref" href="#fn:18">1</a></sup></p>
<p>If an attacker can control this role and identify an application that has a service principal assigned a higher-privileged role, then they can obtain access to that higher-privileged role.</p>
</li>
<li>
<p>A PRA can reset credentials and manage assignment of all Microsoft Entra ID roles including the Global Administrator role<sup id="fnref:14"><a class="footnote-ref" href="#fn:14">2</a></sup>.</p>
<p>This is a prime target for an attacker attempting to perform privilege escalation. If an attacker obtains this role, then they could become Global Administrator.</p>
</li>
<li>
<p>A Global Administrator has the ability to create and manage a new subscription, and access to all administrative features within the subscription's associated tenant.<sup id="fnref:15"><a class="footnote-ref" href="#fn:15">3</a></sup><sup>,</sup><sup id="fnref:16"><a class="footnote-ref" href="#fn:16">4</a></sup><sup>,</sup><sup id="fnref:17"><a class="footnote-ref" href="#fn:17">5</a></sup></p>
<p>This role is 'the keys to the kingdom' -- If an attacker obtains this role, then they control the subscription's tenant!</p>
</li>
</ul>
<p>This information indicates a potential security issue upon which to focus our attention. If an attacker could find a way to obtain the Application Administrator role, then they could reset the credentials or client secrets for a service principal that is granted the PRA role. Once an attacker has the PRA role, then they could elevate their privileges to Global Administrator.</p>
<p><strong>Our new goal, then, is to execute that attack path as a practical illustration of the security risks in Tyrell Corp's current Microsoft Entra ID environment.</strong></p>
<p>However, creating the test Microsoft Entra ID environment by hand would be extremely time-consuming, tedious, and error-prone. So we'll use the <a href="https://github.com/iknowjason/PurpleCloud" rel="noopener" target="_blank">PurpleCloud</a><sup id="fnref:3"><a class="footnote-ref" href="#fn:3">7</a></sup><sup>,</sup><sup id="fnref:12"><a class="footnote-ref" href="#fn:12">8</a></sup> tool to generate lists of semi-random Entra ID applications and users as stand-ins for Tyrell Corp's fictitious Entra ID environment. PurpleCloud will also generate Terraform configuration files representing those applications and users. Then we'll use a Terraform client to generate the test environment from those configuration files.</p>
<h2 id="lab-preparation">Lab Preparation</h2>
<p>Before starting this lab, you must have already completed the <a href="../../a1/sec530.bonus.a1/" rel="noopener" target="_blank">Azure Account Setup</a> lab.</p>
<div class="admonition reminder">
<p class="admonition-title">Current State</p>
<p>At this point, you should:</p>
<ul>
<li>
<p>Have an Azure account and subscription identified to use for the rest of the labs.</p>
</li>
<li>
<p>Be logged into <a href="https://portal.azure.com" rel="noopener" target="_blank">https://portal.azure.com</a> with your Azure account.</p>
</li>
<li>
<p>Have your own copy of the <a href="../../a1/sec530.bonus.a1/#7-open-azure-notes-workbook" rel="noopener" target="_blank">Azure-Notes workbook</a> open, with your Azure subscription and tenant IDs recorded.</p>
</li>
</ul>
</div>
<h2 id="step-by-step-instructions">Step-by-Step Instructions</h2>
<details class="example">
<summary>1. Start Azure Cloud Shell Session - bash</summary>
<h3 class="hidden_element" id="1-start-azure-cloud-shell-session-bash">1. Start Azure Cloud Shell Session - bash</h3>
<p>While some of the Azure environment setup can be readily performed via the Azure portal, other parts can be done more efficiently using the Azure command-line interface (Azure CLI). The Azure command-line interface (Azure CLI) is a set of commands used to create and manage Azure resources. The Azure CLI is available across Azure services and is designed to get you working quickly with Azure, with an emphasis on automation. <sup id="fnref:19"><a class="footnote-ref" href="#fn:19">9</a></sup></p>
<p>The simplest way to access the Azure CLI is to use the Azure Cloud Shell service. Azure Cloud Shell is a really nice shell environment that you can access from a browser and allows you to easily perform tasks with your Azure account. The Cloud Shell obviates the need for an external VM or tools to access a shell in your cloud environment. You can perform file management such as storing, uploading, and downloading files. It offers either a PowerShell or bash shell environment.<sup id="fnref:20"><a class="footnote-ref" href="#fn:20">10</a></sup></p>
<details class="note">
<summary>If You Are Using an Existing Azure Account</summary>
<p>If you are using an existing Azure Azure account, instead of creating an account for this workshop, then the presented prompts and dialogs may slightly differ from those presented below.</p>
</details>
<ol>
<li>
<p>Switch back to the browser tab accessing the Azure portal <a href="https://portal.azure.com" rel="noopener" target="_blank">https://portal.azure.com</a>.</p>
</li>
<li>
<p><strong>Click</strong> on the <strong>Cloud Shell</strong> icon at the top of the page, immediately to the right of the search bar.</p>
<p><img alt=" " class="noborder" src="../../media/azure-cloud-shell-open.png" /></p>
</li>
<li>
<p>You will be presented with a "Welcome to Azure Cloud Shell" prompt, and given the option to select either Bash or PowerShell. <strong>Click</strong> on the <strong>Bash</strong> option.</p>
<p><img alt=" " class="noborder" src="../media/azure-cloud-shell-select-bash.png" /></p>
<details class="info">
<summary>Picking a Shell</summary>
<p>Azure Cloud Shell allows you to switch between bash and PowerShell at any time. We'll use bash for this lab, and check out PowerShell in a later lab.</p>
</details>
</li>
<li>
<p>You will be presented with a "Getting started" prompt.</p>
<ul>
<li><strong>Click on the </strong>Mount storage account** radio button.</li>
<li><strong>Click</strong> on the <strong>Subscription</strong> dropdown and select the subscription you are using for these labs.</li>
<li><strong>Click</strong> on the <strong>Apply</strong> command button.</li>
</ul>
<p><img alt=" " class="noborder" src="../media/azure-cloud-shell-create-storage.png" /></p>
</li>
<li>
<p>You will be presented with a "Mount storage account" prompt.</p>
<ul>
<li><strong>Click</strong> on the <strong>We will create a storage account for you</strong> radio button.</li>
<li><strong>Click</strong> on the <strong>Next</strong> command button.</li>
</ul>
<p><img alt=" " class="noborder" src="../media/azure-cloud-shell-mount-storage.png" /></p>
<p>This step is important because it  allows your environment to run bash commands using the Azure CLI tool (referred to as 'az')<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">11</a></sup>, and to maintain persistent storage between Cloud Shell sessions.</p>
<p>After a few minutes, the bottom half of your web browser tab will display a bash terminal prompt.</p>
<p><img alt=" " class="noborder" src="../../media/azure-cloud-shell-bash-prompt.png" /></p>
<div class="admonition note">
<p class="admonition-title">The standard Azure Cloud Shell prompt includes the account user name, and so will be different than the prompt in the screenshot above.</p>
</div>
</li>
<li>
<p>Let's make the terminal output slightly more readable by changing the terminal prompt, to remove host name and add a line-break before the prompt. Execute the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>PS1=&#39;\n\[\e[1;32m\][ \[\e[0m\]\w\[\e[1;32m\] ]$ \[\e[0m\]&#39;
</code></pre></div>
</div>
<details class="tip" open="open">
<summary>Copy and Paste with the Cloud Shell Terminal</summary>
<p>The Cloud Shell terminal is running inside of a web browser, and the shortcut keys that you're used to might not work as you expect.</p>
<p>To paste content into the terminal, <strong>right-click</strong> in the terminal window and select <strong>Paste</strong> from the context menu.</p>
<p>To copy content from the terminal window, <strong>click and drag</strong> to select text, <strong>right-click</strong> to activate the context menu, and select <strong>Copy</strong> from the context menu.</p>
<p>When pasting a command into a Cloud Shell bash terminal, you may need to press the <strong>Enter</strong> key again after pasting the command.</p>
</details>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>sec530-labs-azure-sec530-labs-xp [ ~ ]$ PS1=&#39;\n\[\e[1;32m\][ \[\e[0m\]\w\[\e[1;32m\] ]$ \[\e[0m\]&#39;

[ ~ ]$
</code></pre></div>
</div>
<p>This will stay in effect for the duration of this Cloud Shell session.</p>
<details class="info">
<summary>Restoring the Shell Prompt</summary>
<p>If you decide that you'd prefer to use the original shell prompt, then you can execute the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>PS1=&#39;\[\e[1;32m\]\u [ \[\e[0m\]\w\[\e[1;32m\] ]$ \[\e[0m\]&#39;
</code></pre></div>
</div>
<p>You could also simply exit and restart your Cloud Shell session -- but note that any changes to the shell environment, including setting other environment variables, will be have to be redone!</p>
</details>
<details class="tip">
<summary>Permanently Changing the Shell Prompt</summary>
<p>If you wanted to change the shell prompt permanently, then you could edit your Cloud Shell <code>.bashrc</code> file to add the command above, or to replace the existing command that sets the PS1 environment variable.</p>
</details>
<details class="tip">
<summary>Maximizing the Shell</summary>
<p>You can maximize the shell by <strong>clicking</strong> on the 'maximize' icon near the top-right of the terminal window.</p>
<p><img alt=" " class="noborder" src="../../media/azure-cloud-shell-maximize.png" /></p>
</details>
</li>
</ol>
<details class="success">
<summary>Your Cloud Shell is now ready to use.</summary>
<p>You used the Azure Cloud Shell service to start a bash shell, and configured an associated storage provider so that you have persistent storage between Cloud Shell sessions.</p>
</details>
</details>
<details class="example">
<summary>2. Prepare az for Use</summary>
<h3 class="hidden_element" id="2-prepare-az-for-use">2. Prepare az for Use</h3>
<p>Now that we have a bash shell started, let's configure the environment for the az commands that we're going to run.</p>
<ol>
<li>
<p>We need to set the active subscription used by the az command, so that any az commands default to referencing that subscription when creating or managing any resources.</p>
<p>First get a list of available subscriptions by executing the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az account list
</code></pre></div>
</div>
<p>Your output should be similar to the sample output below. In particular, you should see one subscription listed, with the subscription ID listed in the 'id' property value and the tenant ID listed in the 'tenantId' property value.</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ az account list
[
  {
    &quot;cloudName&quot;: &quot;AzureCloud&quot;,
    &quot;homeTenantId&quot;: &quot;f6edcda7-02bc-4daa-972d-15567f6e3bb6&quot;,
<span class="hll">    &quot;id&quot;: &quot;7551c4d0-3cab-4286-a39d-f3964ecd9191&quot;,
</span>    &quot;isDefault&quot;: true,
    &quot;managedByTenants&quot;: [],
    &quot;name&quot;: &quot;sans-dev-student-79e4d10cee7f&quot;,
    &quot;state&quot;: &quot;Enabled&quot;,
<span class="hll">    &quot;tenantId&quot;: &quot;f6edcda7-02bc-4daa-972d-15567f6e3bb6&quot;,
</span>    &quot;user&quot;: {
      &quot;cloudShellID&quot;: true,
      &quot;name&quot;: &quot;sec530-labs-azure-sec530-labs-xphsi@sansdevstudent79e4d10cee7f.onmicrosoft.com&quot;,
      &quot;type&quot;: &quot;user&quot;
    }
  }
]

[ ~ ]$
</code></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">The names and IDs of your Azure account, tenant, and subscription will be different from the screenshots and sample output in these step-by-step instructions.</p>
</div>
<details class="note">
<summary>If You Are Using an Existing Azure Account</summary>
<p>If you are using an existing Azure Azure account, instead of creating an account for this workshop, then you may see multiple subscriptions. Make sure that you identify the correct subscription that you want to use.</p>
</details>
<details class="tip">
<summary>To see just specific ID values...</summary>
<p>Execute the following commands:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az account list | jq &#39;.[0].id&#39; -r
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>az account list | jq &#39;.[0].tenantId&#39; -r
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Ouput</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ az account list | jq &#39;.[0].id&#39; -r
7551c4d0-3cab-4286-a39d-f3964ecd9191

[ ~ ]$ az account list | jq &#39;.[0].tenantId&#39; -r
f6edcda7-02bc-4daa-972d-15567f6e3bb6

[ ~ ]$
</code></pre></div>
</div>
</details>
</li>
<li>
<p>So that we can reference the subscription and tenant IDs in later commands, we'll save these values in bash environment variables. <strong>But before you do that</strong>, take a moment to compare the displayed subscription and tenant IDs to those that you recorded in your <a href="../../a1/sec530.bonus.a1/#8-record-subscription-and-tenant-ids" rel="noopener" target="_blank">Azure-Notes workbook</a>.</p>
<ul>
<li>
<p>If the displayed subscription and tenant IDs <strong>do</strong> match those you previously recorded:</p>
<details class="example">
<summary>Then do this...</summary>
<p>Execute the following commands:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>subscriptionId=&quot;$(az account list --query &quot;[?isDefault].id&quot; -o tsv)&quot;
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>tenantId=&quot;$(az account list --query &quot;[?isDefault].tenantId&quot; -o tsv)&quot;
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>echo ${subscriptionId}
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>echo ${tenantId}
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ subscriptionId=$(az account list --query &quot;[?isDefault].id&quot; -o tsv)

[ ~ ]$ tenantId=$(az account list --query &quot;[?isDefault].tenantId&quot; -o tsv)

[ ~ ]$ echo ${subscriptionId}
7551c4d0-3cab-4286-a39d-f3964ecd9191

[ ~ ]$ echo ${tenantId}
f6edcda7-02bc-4daa-972d-15567f6e3bb6

[ ~ ]$
</code></pre></div>
</div>
</details>
</li>
<li>
<p>If the displayed subscription and tenant IDs do <strong>not</strong> match those you previously recorded:</p>
<p><strong>Double-check</strong> to make sure you're comparison is correct and that you do in fact have the correct subscription ID and tenant ID recorded. <strong>If you're certain</strong>...</p>
<details class="example">
<summary>Then do this...</summary>
<p>The Azure-Notes workbook contains some cells with calculated values to make it easier for you to retrieve and set environment variables in the future. Since you populated the subscription ID and tenant ID values, you can:</p>
<ol>
<li>
<p>Copy the contents of cells H3:H4.</p>
<p><img alt=" " class="noborder" src="../media/azure-copy-subscription-tenant.png" /></p>
</li>
<li>
<p>Paste the copied cells to your Cloud Shell terminal window.</p>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ subscriptionId=&#39;7551c4d0-3cab-4286-a39d-f3964ecd9191&#39;
tenantId=&#39;83f4ed17-d5cf-4660-afdc-c4ee2513366c&#39;

[ ~ ]$
</code></pre></div>
</div>
</li>
<li>
<p>Execute the commands below to validate that the environment variables are set.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>echo ${subscriptionId}
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>echo ${tenantId}
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ echo ${subscriptionId}
7551c4d0-3cab-4286-a39d-f3964ecd9191

[ ~ ]$ echo ${tenantId}
f6edcda7-02bc-4daa-972d-15567f6e3bb6

[ ~ ]$
</code></pre></div>
</div>
</li>
</ol>
<p>Since we're specifying a subscription ID that is different than the current active subscription, let's set the active subscription for subsequent az commands.</p>
<p>Execute the following commands:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az account set --subscription=&quot;${subscriptionId}&quot;
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>az account list --query &quot;[?isDefault]&quot;
</code></pre></div>
</div>
<p>Your output should be similar to the sample output below. In particular, note that the 'id' property value matches the subscription ID that you intend to use, and that the 'isDefault' property value is 'true'.</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ az account set --subscription=&quot;${subscriptionId}&quot;

[ ~ ]$ az account list --query &quot;[?isDefault]&quot;
[
{
    &quot;cloudName&quot;: &quot;AzureCloud&quot;,
    &quot;homeTenantId&quot;: &quot;f6edcda7-02bc-4daa-972d-15567f6e3bb6&quot;,
<span class="hll">    &quot;id&quot;: &quot;7551c4d0-3cab-4286-a39d-f3964ecd9191&quot;,
</span><span class="hll">    &quot;isDefault&quot;: true,
</span>    &quot;managedByTenants&quot;: [],
    &quot;name&quot;: &quot;sans-dev-student-79e4d10cee7f&quot;,
    &quot;state&quot;: &quot;Enabled&quot;,
    &quot;tenantId&quot;: &quot;f6edcda7-02bc-4daa-972d-15567f6e3bb6&quot;,
    &quot;user&quot;: {
    &quot;cloudShellID&quot;: true,
    &quot;name&quot;: &quot;sec530-labs-azure-sec530-labs-xphsi@sansdevstudent79e4d10cee7f.onmicrosoft.com&quot;,
    &quot;type&quot;: &quot;user&quot;
    }
}
]

[ ~ ]$
</code></pre></div>
</div>
<details class="tip">
<summary>To see just the 'id' and 'isDefault' property values......</summary>
<p>Execute the following commands:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az account list --query &quot;[?isDefault]&quot; | jq &#39;.[0].id&#39; -r
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>az account list --query &quot;[?isDefault]&quot; | jq &#39;.[0].isDefault&#39; -r
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ az account list --query &quot;[?isDefault]&quot; | jq &#39;.[0].id&#39; -r
7551c4d0-3cab-4286-a39d-f3964ecd9191

[ ~ ]$ az account list --query &quot;[?isDefault]&quot; | jq &#39;.[0].isDefault&#39; -r
true

[ ~ ]$
</code></pre></div>
</div>
</details>
</details>
</li>
</ul>
<details class="info">
<summary>Working With Azure Subscriptions</summary>
<p>See the Microsoft web page <a href="https://learn.microsoft.com/en-us/cli/azure/manage-azure-subscriptions-azure-cli" rel="noopener" target="_blank"><strong>How to manage Azure subscriptions with the Azure CLI</strong></a><sup id="fnref:5"><a class="footnote-ref" href="#fn:5">12</a></sup> for additional information on using az to work with Azure subscriptions.</p>
</details>
</li>
</ol>
<details class="success">
<summary>The bash shell environment is now ready for use with our az commands.</summary>
<p>Checking (and setting, if necessary) the active subscription ensures that subsequent az commands will default to the correct subscription.</p>
<p>Setting environment variables for the subscription and tenantIds allows us to use those environment variables in future commands, which will save time and minimize potential errors.</p>
</details>
</details>
<details class="example">
<summary>3. Create a Service Principal</summary>
<h3 class="hidden_element" id="3-create-a-service-principal">3. Create a Service Principal</h3>
<ol>
<li>
<p>Now we need to create a new application and associated service principal for use with Azure role-based access control (Azure RBAC). Azure RBAC helps you manage who has access to Azure resources, what they can do with those resources, and what areas they have access to.<sup id="fnref:6"><a class="footnote-ref" href="#fn:6">13</a></sup></p>
<details class="tip">
<summary>But I already created the SP-Attack Application and Service Principal!</summary>
<p>If you are revisiting this lab and have already created the SP-Attack application and service principal, then you can retrieve information about the existing application with the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az ad app list --query &quot;[?displayName==&#39;SP-Attack&#39;]&quot;
</code></pre></div>
</div>
<p>From that output, you can retrieve the application ID.</p>
<p id="reset-sp-password">If you lost the associated service principal's password, then you could reset the associated service principal password with the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az ad sp credential reset --id YOUR_APPLICATION_ID
</code></pre></div>
</div>
<details class="danger">
<summary>Deleting the SP-Attack Application</summary>
<p>And if you <strong>really</strong> want to start this lab from scratch, you can delete the existing SP-Attack application and service principal with the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az ad app delete --id YOUR_APPLICATION_ID
</code></pre></div>
</div>
</details>
</details>
<p>We want the service principal to have a role of 'Owner', scoped to your active subscription, with a name of 'SP-Attack'. Execute the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az ad sp create-for-rbac --role=&quot;Owner&quot; --scopes=&quot;/subscriptions/${subscriptionId}&quot; --name &quot;SP-Attack&quot;
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ az ad sp create-for-rbac --role=&quot;Owner&quot; --scopes=&quot;/subscriptions/${subscriptionId}&quot; --name &quot;SP-Attack&quot;
Creating &#39;Owner&#39; role assignment under scope &#39;/subscriptions/7551c4d0-3cab-4286-a39d-f3964ecd9191&#39;
The output includes credentials that you must protect. Be sure that you do not include these credentials in your code or check the credentials into your source control. For more information, see https://aka.ms/azadsp-cli
{
  &quot;appId&quot;: &quot;ddb3c9bd-b976-41a8-9daa-6ad3e973c7b7&quot;,
  &quot;displayName&quot;: &quot;SP-Attack&quot;,
  &quot;password&quot;: &quot;1yT8Q~vP1OyGI~gOm3yvkwWQOhji-rPntKWd6b.u&quot;,
  &quot;tenant&quot;: &quot;f6edcda7-02bc-4daa-972d-15567f6e3bb6&quot;
}

[ ~ ]$
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">The password is automatically generated by Azure, cannot be retrieved later, and cannot be changed to a user-defined password.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">If you need to reset the service principal password in the future, then se <a href="#reset-sp-password">the tip above</a>.</p>
</div>
<p>As with the subscription ID and tenantId, the appID and application password can be retrieved and saved in shell environment variables for easy reference and use in later commands.</p>
<p>Execute the commands below to save the appId value in a variable and display the contents of the variable.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>appId=$(az ad sp list --query &quot;[?displayName == &#39;SP-Attack&#39;].appId&quot; --all -o tsv)
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>echo ${appId}
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ appId=$(az ad sp list --query &quot;[?displayName == &#39;SP-Attack&#39;].appId&quot; --all -o tsv)

[ ~ ]$ echo ${appId}
ddb3c9bd-b976-41a8-9daa-6ad3e973c7b7

[ ~ ]$
</code></pre></div>
</div>
<p>Execute the command below <strong>after replacing the placeholder text 'YOUR_SP_PASSWORD' with the password that was provided in the results of the <code>az ad sp create-for-rbac</code> command.</strong></p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>appPassword=&#39;YOUR_SP_PASSWORD&#39;
</code></pre></div>
</div>
<p>Then execute the command below to display the contents of the variable.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>echo ${appPassword}
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ appPassword=&#39;1yT8Q~vP1OyGI~gOm3yvkwWQOhji-rPntKWd6b.u&#39;

[ ~ ]$ echo ${appPassword}
1yT8Q~vP1OyGI~gOm3yvkwWQOhji-rPntKWd6b.u

[ ~ ]$
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Security Warning</p>
<p>Saving a plaintext password in an environment variable is not a strong security practice, and not something we'd want to do on a production system!</p>
</div>
</li>
<li>
<p>Verify that you can successfully login to Azure with the service principal's password using the <code>az login</code> command.</p>
<p>Switch back to the browser tab that contains the Cloud Shell terminal window, and enter the command below.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az login --service-principal -u ${appId} --tenant ${tenantId} -p ${appPassword}
</code></pre></div>
</div>
<p>Your output should be similar to the sample output below. In particular, the user name value should match the appId value that was returned by the <code>az ad sp create-for-rbac</code> command; and the type should be 'servicePrincipal'.</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ az login --service-principal -u ${appId} --tenant ${tenantId} -p ${appPassword}
Cloud Shell is automatically authenticated under the initial account signed-in with. Run &#39;az login&#39; only if you need to use a different account
[
  {
    &quot;cloudName&quot;: &quot;AzureCloud&quot;,
    &quot;homeTenantId&quot;: &quot;f6edcda7-02bc-4daa-972d-15567f6e3bb6&quot;,
    &quot;id&quot;: &quot;7551c4d0-3cab-4286-a39d-f3964ecd9191&quot;,
    &quot;isDefault&quot;: true,
    &quot;managedByTenants&quot;: [],
    &quot;name&quot;: &quot;sans-dev-student-79e4d10cee7f&quot;,
    &quot;state&quot;: &quot;Enabled&quot;,
    &quot;tenantId&quot;: &quot;f6edcda7-02bc-4daa-972d-15567f6e3bb6&quot;,
    &quot;user&quot;: {
<span class="hll">      &quot;name&quot;: &quot;ddb3c9bd-b976-41a8-9daa-6ad3e973c7b7&quot;,
</span><span class="hll">      &quot;type&quot;: &quot;servicePrincipal&quot;
</span>    }
  }
]

[ ~ ]$
</code></pre></div>
</div>
<details class="note">
<summary>What to do if Your Output States 'A Cloud Shell credential problem occurred' ?</summary>
<p>If your command output includes text similar to one of the following:</p>
<ul>
<li>
<blockquote>
<p>A Cloud Shell credential problem occurred. When you report the issue with the error below, please mention the hostname 'cc-a4b21845-6fd7ffd8f7-lbpr4'</p>
</blockquote>
</li>
<li>
<blockquote>
<p>AADSTS7000215: Invalid client secret provided. Ensure the secret being sent in the request is the client secret value, not the client secret ID, for a secret added to app 'fc437813-772c-42c0-8b31-019157d4f058'.</p>
</blockquote>
</li>
</ul>
<p>... then odds are good that either the appId or appPassword variables are incorrect.</p>
</details>
<details class="tip">
<summary>To see just specific ID values...</summary>
<p>Execute the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>az login --service-principal -u ${appId} --tenant ${tenantId} --query &quot;[].name&quot; -o tsv -p ${appPassword}
</code></pre></div>
</div>
<p>Your output should be similar to the following, displaying either the subscription ID or subscription name:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ az login --service-principal -u ${appId} --tenant ${tenantId} -o tsv -p ${appPassword} --query &quot;[].user.name&quot;
Cloud Shell is automatically authenticated under the initial account signed-in with. Run &#39;az login&#39; only if you need to use a different account
ddb3c9bd-b976-41a8-9daa-6ad3e973c7b7

[ ~ ]$
</code></pre></div>
</div>
</details>
</li>
<li>
<p>The 'appId' and 'password' values in the output of the  <code>az ad sp create-for-rbac</code> command are vital to later steps and labs, so let's copy those values to our Azure-Notes workbook for later reference.</p>
<p><strong>Click and drag</strong> to select the application ID value. Then <strong>right-click</strong> anywhere in the shell to activate a context menu, and select <strong>Copy</strong> from the context menu.</p>
<p><img alt=" " class="noborder" src="../media/az-copy-appid.png" /></p>
<p>Switch to the Azure-Notes workbook, and <strong>paste</strong> the application ID into the cell for the 'Application ID' value.</p>
<p><img alt=" " class="noborder" src="../media/azure-paste-appid.png" /></p>
<p>Switch back to the terminal window. <strong>Click and drag</strong> to select the application password value. Then <strong>right-click</strong> anywhere in the shell to activate a context menu, and select <strong>Copy</strong> from the context menu.</p>
<p><img alt=" " class="noborder" src="../media/az-copy-app-password.png" /></p>
<p>Switch to the Azure-Notes workbook and <strong>paste</strong> the application password into the cell for the 'Application Password' value.</p>
<p><img alt=" " class="noborder" src="../media/azure-paste-app-password.png" /></p>
<div class="admonition danger">
<p class="admonition-title">Watch Out for Autocorrect!</p>
<p>After pasting the password, doublecheck to make sure that Microsoft Excel didn't automatically capitalize the first word of the password. If it did, then edit the text to match the actual password.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Security Warning</p>
<p>Saving a plaintext password in a file is not a strong security practice, and not something we'd want to do on a production system!</p>
</div>
</li>
<li>
<p>We're done with the Cloud Shell terminal for now. Minimize the Cloud Shell terminal window by <strong>clicking</strong> on the 'minimize' icon near the top-right corner of the terminal window.</p>
<p><img alt=" " class="noborder" src="../media/azure-cloud-shell-minimize.png" /></p>
</li>
</ol>
<details class="success">
<summary>Congratulations! You have successfully set up the application and service principal!</summary>
<p>Creating the SP-Attack application and associated service principal will allow us to use that SP-Attack application with Terraform scripts to create users and additional applications -- which allows us to easily stand up and manage our test Azure environment.</p>
<p>Setting environment variables for the application ID for the created application, and the password for the associated service principal, allows us to use those environment variables in future commands, which will save time and minimize potential errors.</p>
<div class="admonition warning">
<p class="admonition-title">Security Warning</p>
<p>Saving a plaintext password in an environment variable or file is not a strong security practice, and not something we'd want to do on a production system!</p>
</div>
</details>
</details>
<details class="example">
<summary>4. Assign Service Principal Permissions</summary>
<h3 class="hidden_element" id="4-assign-service-principal-permissions">4. Assign Service Principal Permissions</h3>
<ol>
<li>
<p>In the Azure portal, open the <strong>App registrations</strong> page to find the SP-Attack application.</p>
<p><strong>Click</strong> on the search bar at the top of the page, enter the text 'app registrations', and select the <strong>App registrations</strong> service from the drop-down.</p>
<div class="admonition cmd">
<p class="admonition-title">Search Term</p>
<div class="highlight"><pre><span></span><code>app registrations
</code></pre></div>
</div>
<p><img alt=" " class="noborder" src="../../media/azure-app-registrations.png" /></p>
</li>
<li>
<p>View the details of the SP-Attack application.</p>
<p>On the <strong>App registrations</strong> page, <strong>click</strong> on the <strong>All applications</strong> option to view all created applications, and then <strong>click</strong> on the icon for the <strong>SP-Attack</strong> application.</p>
<p><img alt=" " class="noborder" src="../../media/azure-view-applications.png" /></p>
<details class="tip">
<summary>Retrieving Application Details</summary>
<p>At this point we're viewing the details of the SP-Attack application. A wealth of useful information can be found on and through this page, including the application ID and tenant ID.</p>
</details>
</li>
<li>
<p>We need to change the Graph API permissions to allow the SP-Attack application to make changes to Microsoft Entra ID resources.</p>
<p>Access the <strong>API permissions</strong> page by scrolling down in the quicklinks at the left side of the page, to find and <strong>click</strong> on the <strong>API Permissions</strong> link.</p>
<p><img alt=" " class="noborder" src="../media/azure-api-permissions.png" /></p>
</li>
<li>
<p id="add-five-permissions">We need to add five different permissions:</p>
<div class="admonition cmd">
<p class="admonition-title">Graph API Permissions</p>
<div class="highlight"><pre><span></span><code>Application.ReadWrite.All
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>Directory.ReadWrite.All
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>Group.ReadWrite.All
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>RoleManagement.ReadWrite.Directory
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>User.ReadWrite.All
</code></pre></div>
</div>
<p id="add-graph-api-permission">It's possible to add them all at once, but the portal interface is a bit easier to navigate if we add them one at a time. Let's start with the Application.ReadWrite.All permission.</p>
<ul>
<li>
<p><strong>Click</strong> on <strong>Add a permission</strong>.</p>
<p><img alt=" " class="noborder" src="../media/azure-add-api-permission.png" /></p>
</li>
<li>
<p>On the <strong>Request API permissions</strong> page, <strong>click</strong> on <strong>Microsoft Graph</strong>.</p>
<p><img alt=" " class="noborder" src="../media/azure-graph.png" /></p>
</li>
<li>
<p>To add the permission:</p>
<ul>
<li>
<p><strong>Click</strong> on the <strong>Application permissions</strong> box.</p>
</li>
<li>
<p>In the <strong>Select permissions</strong> search box, enter 'application.readwrite.all'.</p>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>application.readwrite.all
</code></pre></div>
</div>
</li>
<li>
<p><strong>Click</strong> to expand the permissions available for the Application role.</p>
</li>
<li>
<p><strong>Click</strong> to enable the checkbox next to the <strong>Application.ReadWrite.All</strong> permission.</p>
</li>
<li>
<p><strong>Click</strong> on the <strong>Add permissions</strong> command button.</p>
</li>
</ul>
<p><img alt=" " class="noborder" src="../media/azure-add-readwrite-permission.png" /></p>
</li>
</ul>
<p>That takes care of the first permission! Now repeat that process for <a href="#add-five-permissions">each of the remaining required permissions</a>.</p>
</li>
<li>
<p>After adding permissions, the browser will be returned to the <strong>SP-Attack | API permissions</strong> page. Added permissions will be listed at the bottom of the page. Verify that all of the following permissions have been successfully added:</p>
<ul>
<li>Application.ReadWrite.All</li>
<li>Directory.ReadWrite.All</li>
<li>Group.ReadWrite.All</li>
<li>RoleManagement.ReadWrite.Directory</li>
<li>User.ReadWrite.All</li>
</ul>
<p><img alt=" " class="noborder" src="../media/azure-added-permissions.png" /></p>
</li>
<li>
<p>Now that we've added the five permissions, we must grant them consent within the Default Directory of your tenant. By default, admin consent is required.</p>
<p><strong>Click</strong> on the <strong>Grant admin consent</strong> link, just above the list of added permissions. When prompted to confirm, <strong>click</strong> the <strong>Yes</strong> command button.</p>
<p><img alt=" " class="noborder" src="../media/azure-grant-admin-consent.png" /></p>
<p>In the list of permissions, <strong>scroll</strong> to the right to expose the <strong>Status</strong> column, and confirm that the status is now 'Granted' (with a green check mark) for all five permissions.)</p>
<p><img alt=" " class="noborder" src="../media/azure-granted-admin-consent.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even after you grant consent, the <strong>Grant admin consent</strong> option will still be visible. This is normal. Check the <strong>Status</strong> column to confirm the status of listed permissions.</p>
</div>
</li>
</ol>
<details class="success">
<summary>Congratulations! You have successfully set up the application and service principal!</summary>
<p>So that the SP-Attack application has the permissions needed to create and manage our test environment's users and applications, we assigned the application's service principal the following permissions (and consent to exercise these permissions throughout the tenant):</p>
<ul>
<li>Application.ReadWrite.All</li>
<li>Directory.ReadWrite.All</li>
<li>Group,.ReadWrite.All</li>
<li>RoleManagement.ReadWrite.Directory</li>
<li>User.ReadWrite.All</li>
</ul>
</details>
</details>
<details class="example">
<summary>5. Install PurpleCloud</summary>
<h3 class="hidden_element" id="5-install-purplecloud">5. Install PurpleCloud</h3>
<p>Now let's install PurpleCloud!</p>
<ol>
<li>
<p><strong>Click</strong> on the <strong>Cloud Shell</strong> icon at the top of the page, immediately to the right of the search bar, to re-open the Cloud Shell bash terminal.</p>
<p><img alt=" " class="noborder" src="../../media/azure-cloud-shell-open.png" /></p>
<div class="admonition note">
<p class="admonition-title">If you are receive a <strong>Cloud Shell disconnected</strong> prompt, then <strong>click</strong> on the <strong>Connect</strong> command button to reconnect to a Cloud Shell bash terminal.</p>
</div>
</li>
<li>
<p>Execute the command below to clone the PurpleCloud GitHub repository to your Cloud Shell bash environment.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/iknowjason/PurpleCloud.git 
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ git clone https://github.com/iknowjason/PurpleCloud.git 
Cloning into &#39;PurpleCloud&#39;...
remote: Enumerating objects: 2185, done.
remote: Counting objects: 100% (574/574), done.
remote: Compressing objects: 100% (238/238), done.
remote: Total 2185 (delta 353), reused 394 (delta 293), pack-reused 1611
Receiving objects: 100% (2185/2185), 42.36 MiB | 13.28 MiB/s, done.
Resolving deltas: 100% (1162/1162), done.

[ ~ ]$
</code></pre></div>
</div>
</li>
<li>
<p>Faker is a Python package that generates fake or test data for databases, XML documents, and many other purposes.<sup id="fnref2:13"><a class="footnote-ref" href="#fn:13">6</a></sup> PurpleCloud uses it to generate semi-random user data.</p>
<p>Execute the command below to install the Python Faker. </p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>pip3 install faker
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>Defaulting to user installation because normal site-packages is not writeable
Collecting faker
Downloading Faker-25.2.0-py3-none-any.whl.metadata (15 kB)
Requirement already satisfied: python-dateutil&gt;=2.4 in /usr/lib/python3.9/site-packages (from faker) (2.9.0.post0)
Requirement already satisfied: six&gt;=1.5 in /usr/lib/python3.9/site-packages (from python-dateutil&gt;=2.4-&gt;faker) (1.16.0)
Downloading Faker-25.2.0-py3-none-any.whl (1.8 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 7.0 MB/s eta 0:00:00
Installing collected packages: faker
WARNING: The script faker is installed in &#39;/home/greg/.local/bin&#39; which is not on PATH.
Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
NOTE: The current PATH contains path(s) starting with `~`, which may not be expanded by all applications.
Successfully installed faker-25.2.0

[ ~ ]$
</code></pre></div>
</div>
</li>
</ol>
<div class="admonition success">
<p class="admonition-title">PurpleCloud and its dependencies are now installed!</p>
</div>
</details>
<details class="example">
<summary>6. Obtain Microsoft Entra ID Domain Name</summary>
<h3 class="hidden_element" id="6-obtain-microsoft-entra-id-domain-name">6. Obtain Microsoft Entra ID Domain Name</h3>
<p>When executing the PurpleCloud script, we'll need to provide the Microsoft Entra ID environment's primary domain. We can obtain that from the Azure portal.</p>
<ol>
<li>
<p>Access the Azure portal's <strong>Microsoft Entra ID</strong> service page.</p>
<p><strong>Click</strong> on the search bar at the top of the page, enter the text 'microsoft entra id', and select the <strong>Microsoft Entra ID</strong> service from the drop-down.</p>
<div class="admonition cmd">
<p class="admonition-title">Search Term</p>
<div class="highlight"><pre><span></span><code>microsoft entra id
</code></pre></div>
</div>
<p><img alt=" " class="noborder" src="../../media/azure-active-directory.png" /></p>
</li>
<li>
<p>The right-hand pane of the web page will display basic information about your Microsoft Entra ID environment, including your primary domain name.</p>
<p><img alt=" " class="noborder" src="../media/azure-primary-domain.png" /></p>
</li>
<li>
<p>Copy the primary domain name from the web page into your clipboard.</p>
</li>
<li>
<p>Switch to the Azure-Notes workbook, and <strong>paste</strong> the primary domain name into the cell for the 'Primary Domain Name' value.</p>
<p><img alt=" " class="noborder" src="../media/paste-primary-domain-name.png" /></p>
<div class="admonition warning">
<p class="admonition-title">PurpleCloud will use the primary domain name as the UPN suffix to create the Microsoft Entra ID environment. This needs to be accurate or the Terraform commands will fail!</p>
</div>
<details class="info">
<summary>Using a Custom Domain</summary>
<p>You can optionally add a custom domain to Microsoft Entra ID and set the custom domain as your primary domain. If you have a custom domain that you would like to add to Microsoft Entra ID and use in this lab, then browse to <a href="https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/add-custom-domain" rel="noopener" target="_blank">this</a><sup id="fnref:7"><a class="footnote-ref" href="#fn:7">14</a></sup> official Microsoft link. You would then need to modify the rest of the Azure lab instructions to match your custom domain!</p>
</details>
</li>
<li>
<p>We need to save the primary domain name suffix in a bash environment variable so that we can reference it in other commands. The Azure-Notes workbook can help with this, because it contains some cells with calculated values to make it easier for you to retrieve and set environment variables.</p>
<p>Switch to the Azure-Notes workbook and copy the contents of cell D8.</p>
<p><img alt=" " class="noborder" src="../media/azure-copy-domain.png" /></p>
<p>Switch back to the Cloud Shell bash terminal and paste the copied cell contents.</p>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ export DOMAIN=&#39;sansdevstudent79e4d10cee7f.onmicrosoft.com&#39;

[ ~ ]$
</code></pre></div>
</div>
<p>Execute the command below to validate that the environment variable is set.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>echo ${DOMAIN}
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ echo ${DOMAIN}
sansdevstudent79e4d10cee7f.onmicrosoft.com

[ ~ ]$
</code></pre></div>
</div>
</li>
</ol>
<div class="admonition success">
<p class="admonition-title">You now have the Microsoft Entra ID domain name information saved in a bash environment variable and your Azure-Notes workbook.</p>
</div>
</details>
<details class="example">
<summary>7. Execute PurpleCloud Script</summary>
<h3 class="hidden_element" id="7-execute-purplecloud-script">7. Execute PurpleCloud Script</h3>
<p>Now let's run a PurpleCloud script to generate Terraform files!</p>
<p>PurpleCloud uses Python templates to generate Terraform files, which can then be used by Terraform to provision an Microsoft Entra ID environment. PurpleCloud is an incredible time saver versus  manually editing Terraform files. For example, we can dynamically generate hundreds or thousands of Microsoft Entra ID users and assign them to Microsoft Entra ID groups.</p>
<ol>
<li>
<p>Create the directory <code>~/azure</code> and make that your working direectory, so that the PurpleCloud script's output files are stored there.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>cd ~/azure
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>cd ~/azure
</code></pre></div>
</div>
<p>Your output should be:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ] $ cd ~/azure

[ ~/azure ]$
</code></pre></div>
</div>
</li>
<li>
<p>Now execute the PurpleCloud script:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>python3 ~/PurpleCloud/generators/azure_ad/azure_ad.py -c 25 --upn ${DOMAIN} --apps 7 -aa -ga -pra
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<p><span id="purplescript-output"></span></p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ python3 ~/PurpleCloud/generators/azure_ad/azure_ad.py -c 25 --upn sansdevstudent79e4d10cee7f.onmicrosoft.com --apps 7 -aa -ga -pra
[+] Number of users desired:  25
[+] upn suffix:  sansdevstudent79e4d10cee7f.onmicrosoft.com
[+] Desired applications enabled:   7
[+] Creating unique user list
[+] Number of users added into list:  25
[+] Number of duplicate users filtered out:  0
[+] Creating output files for Azure AD Users
    [+] Users csv file:  azure_users.csv
    [+] Username txt file:  azure_usernames.txt
    [+] Email addresses txt file:  azure_emails.txt
    [+] Terraform file:  users.tf
[+] Creating terraform file:  apps.tf
<span class="hll">    [+] Assigning the Privileged Role Administrator to Marketing_Application
</span><span class="hll">    [+] Assigning the Global Administrator role to ITOps_Application
</span><span class="hll">[+] Azure AD User assigned into Application Administrator role
</span><span class="hll">    [+] Username: benjaminwaters
</span>    [+] Display Name: Benjamin Waters

[ ~/azure ]$
</code></pre></div>
</div>
<div class="admonition info">
<p class="admonition-title">PurpleCloud Script Details</p>
<p>Let's dig into this command (i.e., the script arguments) a bit to understand what it's doing.</p>
<ul>
<li><code>python3 /labs/purplecloud/generators/azure_ad/azure_ad.py</code> : Use the Python3 interpreter to execute the script at <code>/labs/purplecloud/generators/azure_ad/azure_ad.py</code>.</li>
<li><code>-c 25</code> : Generate Terraform code representing 25 users with semi-random names.</li>
<li><code>-upn ${DOMAIN}</code> : Give the users a UPN suffix of the domain saved in the DOMAIN environment variable (which we set in the previous lab step).</li>
<li><code>--aps 7</code> : Generate Terraform code representing 7 Microsoft Entra ID applications (i.e., application registrations) and associated service principals.</li>
<li><code>-aa</code> : Assign an Application Administrator role to one of the 25 Microsoft Entra ID users, at random.</li>
<li><code>-ga</code> : Assign the Global Administrator role to one of the 7 application's service principal, at random.</li>
<li><code>-pra</code> : Assign the Privileged Role Administrator role to one of the other 7 application's service principal, at random.</li>
</ul>
</div>
<p>These options were chosen to emulate our hypothetical Tyrell Corp Microsoft Entra ID environment, as described in this lab's <a href="#introduction">Introduction</a>.</p>
<p>Note that in the script output <a href="#purplescript-output">above</a>, we highlighted the following lines:</p>
<ul>
<li>
<p>The name of the application that was assigned the Privileged Role Administrator (PRA) role: Marketing_Application</p>
</li>
<li>
<p>The name of the application that was assigned the Global Administrator role: ITOps_Application</p>
</li>
<li>
<p>The name of the Microsoft Entra ID user that was assigned the Application Administrator role: benjaminwaters</p>
</li>
</ul>
</li>
<li>
<p>We'll want to reference that key information later, so let's save it to our Azure-Notes workbook.</p>
<p><strong>Click and drag</strong> to select the name of the application assigned the Privileged Role Administrator (PRA) role. Then <strong>right-click</strong> on the text to activate a context menu, and select <strong>Copy</strong> from the context menu.</p>
<p><img alt=" " class="noborder" src="../media/copy-pra-app.png" /></p>
<p>Switch to the Azure-Notes workbook, and <strong>paste</strong> the username into the cell for the 'PRA Application' value.</p>
<p><img alt=" " class="noborder" src="../media/paste-pra-app.png" /></p>
<p>Repeat the above process to copy and paste the Global Administrator Application and the Application Admin Userame.</p>
<p><img alt=" " class="noborder" src="../media/paste-ga-app-aa.png" /></p>
</li>
<li>
<p>Note that the script identified multiple "output files for Azure AD users."</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[+] Creating output files for Azure AD Users
    [+] Users csv file:  azure_users.csv
    [+] Username txt file:  azure_usernames.txt
    [+] Email addresses txt file:  azure_emails.txt
    [+] Terraform file:  users.tf
</code></pre></div>
</div>
<p>Execute the following command to list these files, confirming that the files were created in the current directory:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>ls -1 azure* users*
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ ls -1 azure* users*
azure_emails.txt
azure_usernames.txt
azure_users.csv
users.tf

[ ~/azure ]$
</code></pre></div>
</div>
<p>Let's take a quick look at the first few lines of the <code>azure_*</code> files. Execute the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>head -n 3 azure_*
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ head -n 3 azure*
==&gt; azure_emails.txt &lt;==
justinbanks@sansdevstudent79e4d10cee7f.onmicrosoft.com
alexisblair@sansdevstudent79e4d10cee7f.onmicrosoft.com
kylefoley@sansdevstudent79e4d10cee7f.onmicrosoft.com

==&gt; azure_usernames.txt &lt;==
justinbanks
alexisblair
kylefoley

==&gt; azure_users.csv &lt;==
Justin Banks,justinbanks,justinbanks@sansdevstudent79e4d10cee7f.onmicrosoft.com
Alexis Blair,alexisblair,alexisblair@sansdevstudent79e4d10cee7f.onmicrosoft.com
Kyle Foley,kylefoley,kylefoley@sansdevstudent79e4d10cee7f.onmicrosoft.com

[ ~/azure ]$
</code></pre></div>
</div>
<p>The individual names and email addresses in your output will probably be different than the sample output, but note the following:</p>
<ul>
<li>
<p>The names seems like they could be real user names - but are in fact semi-randomly generated by Python Faker<sup id="fnref:13"><a class="footnote-ref" href="#fn:13">6</a></sup> randomly joining names from a list of first and last names.</p>
</li>
<li>
<p>Information for each user is listed on the same line of each file (e.g., Justin Banks is on the first line of each file).</p>
</li>
<li>
<p>The UPN matches your Microsoft Entra ID primary domain name (i.e., the one that you have saved in the DOMAIN environment variable and specified on the script's command line).</p>
</li>
</ul>
<p>The <code>users.tf</code> file will be used as Terraform instructions. Execute the following command to see an example of its contents:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>tail -n 17 users.tf
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ tail -n 17 users.tf
resource &quot;azuread_user&quot; &quot;user25&quot; {
  user_principal_name = &quot;chelseawatson@${var.upn_suffix}&quot;
  display_name        = &quot;Chelsea Watson&quot;
  mail_nickname       = &quot;chelseawatson&quot;
  password            = local.creds
}

# Activate the Application administrator directory role
resource &quot;azuread_directory_role&quot; &quot;application_admin&quot; {
  display_name = &quot;Application administrator&quot;
}

# Assign Application administrator to a random user
resource &quot;azuread_directory_role_assignment&quot; &quot;assign_application_admin&quot; {
  role_id   = azuread_directory_role.application_admin.object_id
  principal_object_id = azuread_user.user9.object_id
}

[ ~/azure ]$
</code></pre></div>
</div>
<p>Note the following:</p>
<ul>
<li>
<p>user25 is defined as a resource object with properties that will become attributes of an 'azuread_user' (i.e., Microsoft Entra ID user) object. If you were to look at the full contents of <code>users.tf</code>, then you would see this holds true for all 25 users.</p>
</li>
<li>
<p>One of the users (user9 in the sample output abvoe) has been randomly assigned the Application Administrator role. This matches up with the following script output:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[+] Azure AD User assigned into Application Administrator role
    [+] Username: benjaminwaters
    [+] Display Name: Benjamin Waters
</code></pre></div>
</div>
<p>You can validate this by searching your <code>users.tf</code> for the name listed in your PurpleCloud script output. For example, if the user identified in your output were 'user9', then you could execute the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>grep -A 1 &#39;user9&#39; users.tf
</code></pre></div>
</div>
<p>Would generate output similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ grep -A 1 &#39;user9&#39; users.tf
resource &quot;azuread_user&quot; &quot;user9&quot; {
  user_principal_name = &quot;benjaminwaters@${var.upn_suffix}&quot;
--
  principal_object_id = azuread_user.user9.object_id
}

[ ~/azure ]$
</code></pre></div>
</div>
</li>
</ul>
</li>
<li>
<p>Note that the script identified an additional <code>apps.tf</code> Terraform file.</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[+] Creating terraform file:  apps.tf
    [+] Assigning the Privileged Role Administrator to Marketing_Application
    [+] Assigning the Global Administrator role to ITOps_Application
</code></pre></div>
</div>
<p>Execute the following command to list this file, confirming that the file was created in the current directory:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>ls apps.tf
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ ls apps.tf
apps.tf

[ ~/azure ]$
</code></pre></div>
</div>
<p>Let's take a quick look at the first few lines of this file. Execute the following command:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>head -n 12 apps.tf
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ head -n 12 apps.tf

# Create application
  resource &quot;azuread_application&quot; &quot;HR_Application&quot; {
  display_name = &quot;${var.upn_suffix} HR-App&quot;
}

# Create service principal
  resource &quot;azuread_service_principal&quot; &quot;SP_HR_Application&quot; {
  application_id = azuread_application.HR_Application.application_id

  depends_on = [azuread_application.HR_Application]
}

[ ~/azure ]$
</code></pre></div>
</div>
<p>The specific application identified in your output may be different than the sample output, but note how an application and associated service principal are identified. If you were to look at the full contents of <code>apps.tf</code>, then you would see this is the same for all 7 applications.</p>
<p>Now execute the following command to see the last few lines of the <code>apps.tf</code> file:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>tail -n 5 apps.tf
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ tail -n 5 apps.tf
  # Assign GA to a random SP
  resource &quot;azuread_directory_role_assignment&quot; &quot;assign_ga&quot; {
  role_id   = azuread_directory_role.ga.object_id
  principal_object_id = azuread_service_principal.SP_ITOps_Application.object_id
}

[ ~/azure ]$
</code></pre></div>
</div>
<p>This illustrates how the PurpleCloud script creates Terraform instructions to assign a role to a service principal.</p>
</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Congratulations! You have used PurpleCloud to generate Terraform scripts that represent the Microsoft Entra ID environment!</p>
</div>
</details>
<details class="example">
<summary>8. Set Terraform Terminal Environment</summary>
<h3 class="hidden_element" id="8-set-terraform-terminal-environment">8. Set Terraform Terminal Environment</h3>
<p>Terraform is an infrastructure as code (IaC) tool that lets you define both cloud and on-prem resources in human-readable configuration files that you can version, reuse, and share; and then manage the infrastructure throughout its lifecycle.<sup id="fnref:10"><a class="footnote-ref" href="#fn:10">15</a></sup> We'll use Terraform to manager our Microsoft Entra ID lab environment, including tracking the state of the remote resources and tearing down the environment when we're finished.</p>
<p>The Terraform client is already installed in the Cloud Shell bash environment. But before we can run the client we need to create some bash environment variables. These variables are needed by the Terraform client to access our Microsoft Entra ID resources via the Hashicorp Azure Active Directory Provider<sup id="fnref:8"><a class="footnote-ref" href="#fn:8">16</a></sup>, which leverages the Azure Resource Manager<sup id="fnref:9"><a class="footnote-ref" href="#fn:9">17</a></sup>.</p>
<p>The environment variables will contain the values of your subscription ID, tenant ID, application ID, and application password. The Azure property values map to the Terraform environment variables as follows:</p>
<table>
<thead>
<tr>
<th>Azure Information</th>
<th>Terraform Environment Variable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Subscription ID</td>
<td>ARM_SUBSCRIPTION_ID</td>
</tr>
<tr>
<td>Tenant ID</td>
<td>ARM_TENANT_ID</td>
</tr>
<tr>
<td>Application ID</td>
<td>ARM_CLIENT_ID</td>
</tr>
<tr>
<td>Application Password</td>
<td>ARM_CLIENT_SECRET</td>
</tr>
</tbody>
</table>
<p>Conveniently, you saved these values in your Azure-Notes workbook!</p>
<ol>
<li>
<p>Execute the following steps to set the ARM_SUBSCRIPTION_ID environment variable:</p>
<ol>
<li>
<p>Switch to your terminal and enter the following command (<strong>but do not press Enter</strong>):</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>export ARM_SUBSCRIPTION_ID=&#39;YOUR_SUBSCRIPTION_ID&#39;
</code></pre></div>
</div>
</li>
<li>
<p>Switch to your Azure-Notes workbook. Find the subscription ID value, and copy it to the clipboard.</p>
</li>
<li>
<p>Switch to the terminal window and replace the 'YOUR_SUBSCRIPTION_ID' placeholder text with the copied subscription ID.</p>
<div class="admonition warning">
<p class="admonition-title">Make sure to maintain the opening and closing quotes!</p>
</div>
</li>
<li>
<p>Press <strong>Enter</strong> to execute the command.</p>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ export ARM_SUBSCRIPTION_ID=&#39;7551c4d0-3cab-4286-a39d-f3964ecd9191&#39;

[ ~/azure ]$
</code></pre></div>
</div>
</li>
<li>
<p>Execute the command below to display the contents of the environment variable.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>echo ${ARM_SUBSCRIPTION_ID}
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ echo ${ARM_SUBSCRIPTION_ID}
7551c4d0-3cab-4286-a39d-f3964ecd9191

[ ~/azure ]$
</code></pre></div>
</div>
</li>
</ol>
</li>
<li>
<p>Let's take advantage of the Azure-Notes to more easily set the remaining Terraform environment variables.</p>
<ol>
<li>
<p>Copy the contents of cells D3:D6 (which includes the subscription ID that you already set manually).</p>
<p><img alt=" " class="noborder" src="../media/azure-copy-terraform-variables.png" /></p>
</li>
<li>
<p>Paste the copied cells to your Cloud Shell bash terminal.</p>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ export ARM_SUBSCRIPTION_ID=&#39;7551c4d0-3cab-4286-a39d-f3964ecd9191&#39;

[ ~/azure ]$ export ARM_TENANT_ID=&#39;f6edcda7-02bc-4daa-972d-15567f6e3bb6&#39;

[ ~/azure ]$ export ARM_CLIENT_ID=&#39;9d14c1fa-b223-4c9e-a1f1-e298fecf237d&#39;

[ ~/azure ]$ export ARM_CLIENT_SECRET=&#39;T.08Q~D5qSUe6lr94AoHLKABh1iJqNS2XunP4a2y&#39;

[ ~/azure ]$
</code></pre></div>
</div>
</li>
</ol>
</li>
<li>
<p>As a final check, execute the commands below to echo the contents of all four environment variables to your terminal.</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>echo ${ARM_SUBSCRIPTION_ID}
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>echo ${ARM_TENANT_ID}
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>echo ${ARM_CLIENT_ID}
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>echo ${ARM_CLIENT_SECRET}
</code></pre></div>
</div>
<p>Your output should be similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~/azure ]$ echo ${ARM_SUBSCRIPTION_ID}
7551c4d0-3cab-4286-a39d-f3964ecd9191

[ ~/azure ]$ echo ${ARM_TENANT_ID}
f6edcda7-02bc-4daa-972d-15567f6e3bb6

[ ~/azure ]$ echo ${ARM_CLIENT_ID}
9d14c1fa-b223-4c9e-a1f1-e298fecf237d

[ ~/azure ]$ echo ${ARM_CLIENT_SECRET}
T.08Q~D5qSUe6lr94AoHLKABh1iJqNS2XunP4a2y

[ ~/azure ]$
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Validate the output above against your subscription ID, tenant ID, application ID, and application password!</p>
</div>
</li>
</ol>
<div class="admonition success">
<p class="admonition-title">The bash environment variables needed by Terraform are now set.</p>
</div>
</details>
<details class="example">
<summary>9. Execute Terraform</summary>
<h3 class="hidden_element" id="9-execute-terraform">9. Execute Terraform</h3>
<p>Now that we have both the Terraform configuration files (generated by PurpleCloud) and the necessary bash environment variables (set in the previous task), we can run the Terraform client to generate our test Microsoft Entra ID environment.</p>
<ol>
<li>
<p>Let's double-check to make sure those variables are present, by executing the following command</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>env | grep ARM | sort | tr &#39;=&#39; &#39;\t&#39; | column -t
</code></pre></div>
</div>
<p>Your output should be similar to the following (but with different actual environment variable values):</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[~/azure]$ env | grep ARM | sort | tr &#39;=&#39; &#39;\t&#39; | column -t
ARM_CLIENT_ID        9d14c1fa-b223-4c9e-a1f1-e298fecf237d
ARM_CLIENT_SECRET    T.08Q~D5qSUe6lr94AoHLKABh1iJqNS2XunP4a2y
ARM_SUBSCRIPTION_ID  7551c4d0-3cab-4286-a39d-f3964ecd9191
ARM_TENANT_ID        f6edcda7-02bc-4daa-972d-15567f6e3bb6

[~/azure]$
</code></pre></div>
</div>
<p>If your output doesn't list the variables, or the values don't match your application ID, application password, subscription ID, and tenant ID, then you might be in the wrong terminal window; or you might need to revisit task <a href="#8-set-terraform-terminal-environment">8. Set Terraform Terminal Environment</a>.</p>
</li>
<li>
<p>Now let's execute <code>terraform init</code> to tell Terraform to initialize the modules and providers configured in the Terraform code.</p>
<p>Execute the following commands:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>cd ~/azure
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>terraform init
</code></pre></div>
</div>
<p>Your output should match the following, <strong>including the 'Terraform has been successfully initialized!' message</strong>:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[~/azure]$ terraform init

Initializing the backend...

Initializing provider plugins...
- Finding latest version of hashicorp/azuread...
- Finding latest version of hashicorp/random...
- Installing hashicorp/azuread v2.41.0...
- Installed hashicorp/azuread v2.41.0 (signed by HashiCorp)
- Installing hashicorp/random v3.5.1...
- Installed hashicorp/random v3.5.1 (signed by HashiCorp)

Terraform has created a lock file .terraform.lock.hcl to record the provider
selections it made above. Include this file in your version control repository
so that Terraform can guarantee to make the same selections by default when
you run &quot;terraform init&quot; in the future.

<span class="hll">Terraform has been successfully initialized!
</span>
You may now begin working with Terraform. Try running &quot;terraform plan&quot; to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.

[~/azure]$
</code></pre></div>
</div>
</li>
<li>
<p>Now execute <code>terraform apply</code>, to tell Terraform to apply the configuration represented by the current directory's <code>*.tf</code> files.</p>
<p>Execute the following commands:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>terraform apply
</code></pre></div>
</div>
<p>This command will generate over a thousand lines of output, detailing the configuration that the Terraform client is going to apply. Don't worry, you don't need to review it all for this lab!</p>
<div class="admonition note">
<p class="admonition-title">You can safely ignore any warnings about deprecated attributes, arguments, or resources.</p>
</div>
<p>The last of the output will match the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<p><div class="highlight"><pre><span></span><code>Plan: 47 to add, 0 to change, 0 to destroy.
</code></pre></div>
[...]
<div class="highlight"><pre><span></span><code>Changes to Outputs:
  + azure_ad_details = (known after apply)

Do you want to perform these actions?
  Terraform will perform the actions described above.
  Only &#39;yes&#39; will be accepted to approve.

  Enter a value:
</code></pre></div></p>
</div>
<p>Confirm that the output states the plan is to add 47 items, change 0, and destroy 0.</p>
<p>Then enter 'yes' and press the <strong>Enter</strong> key.</p>
<p>Again, a huge amount of output will scroll by -- but we're primarily interested in the last few lines, including the 'Apply complete!' and 'Azure AD Password lines:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code><span class="hll">Apply complete! Resources: 47 added, 0 changed, 0 destroyed.
</span>
Outputs:

azure_ad_details = &lt;&lt;EOT

------------------------------------
Azure AD Security Lab Setup Complete
------------------------------------
<span class="hll">Azure AD Password: amusing-parakeet-hSbg
</span>

EOT

[~/azure]$
</code></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">You can safely ignore any warnings about deprecated attributes, arguments, or resources.</p>
</div>
<p>Make sure that your output includes <code>Apply complete! Resources: 47 added, 0 changed, 0 destroyed.</code></p>
</li>
<li>
<p>Also make sure to look at the <code>Azure AD Password</code> text. The password displayed is randomly generated by Terraform and has been applied to <strong>all</strong> of the generated Microsoft Entra ID users accounts.</p>
<p>You'll need to know this password in a later lab, so save that information to your Azure-Notes workbook for later reference.</p>
<p><strong>Click and drag</strong> to select the password. Then <strong>right-click</strong> on the text to activate a context menu, and select <strong>Copy</strong> from the context menu.</p>
<p><img alt=" " class="noborder" src="../media/copy-user-password.png" /></p>
<p>Switch to the Azure-Notes workbook and <strong>paste</strong> the password into the cell for the 'Random User Password' value.</p>
<p><img alt=" " class="noborder" src="../media/paste-user-password.png" /></p>
<div class="admonition danger">
<p class="admonition-title">Watch Out for Autocorrect!</p>
<p>After pasting the password, doublecheck to make sure that Microsoft Excel didn't automatically capitalize the first word of the password. If it did, then edit the text to match the actual password.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Security Warning</p>
<p>Saving a plaintext password in a file is not a strong security practice, and not something we'd want to do on a production system!</p>
</div>
<details class="tip">
<summary>Retrieving the Random Password</summary>
<p><span id="retrieving-the-random-password"><span></p>
<p>At any point you can return to this working directory and retrieve the password with either these commands:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>cd ~/azure
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>grep &#39;&quot;password&quot;:&#39; terraform.tfstate | sort -u
</code></pre></div>
</div>
<p>Which will generate output similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[ ~ ]$ cd ~/azure

[ ~/azure ]$ grep &#39;&quot;password&quot;:&#39; terraform.tfstate | sort -u
&quot;password&quot;: &quot;amusing-parakeet-hSbg&quot;,

[ ~/azure ]$
</code></pre></div>
</div>
<p>Or these commands:</p>
<div class="admonition cmd">
<p class="admonition-title">Cloud Shell bash Input</p>
<div class="highlight"><pre><span></span><code>cd ~/student/azure
</code></pre></div>
</div>
<div class="admonition cmd">
<div class="highlight"><pre><span></span><code>terraform output
</code></pre></div>
</div>
<p>Which will generate output similar to the following:</p>
<div class="admonition abstract">
<p class="admonition-title">Cloud Shell bash Output</p>
<div class="highlight"><pre><span></span><code>[~]$ cd ~/student/azure

[~/azure]$ terraform output
azure_ad_details = &lt;&lt;EOT

------------------------------------
Azure AD Security Lab Setup Complete
------------------------------------
Azure AD Password: amusing-parakeet-hSbg

EOT

[~/azure]$
</code></pre></div>
</div>
</details>
</li>
<li>
<p>We're done with the Cloud Shell terminal for now. Minimize the Cloud Shell terminal window by <strong>clicking</strong> on the 'minimize' icon near the top-right corner of the terminal window.</p>
<p><img alt=" " class="noborder" src="../media/azure-cloud-shell-minimize.png" /></p>
</li>
<li>
<p>Let's use the Azure portal to manage our Microsoft Entra ID resources, and confirm that the Microsoft Entra ID users and applications have been created.</p>
<p>In the Azure portal, navigate to the <strong>Microsoft Entra ID</strong> page, and select <strong>Users</strong>.</p>
<div class="admonition cmd">
<p class="admonition-title">Search Term</p>
<div class="highlight"><pre><span></span><code>microsoft entra id
</code></pre></div>
</div>
<p><img alt=" " class="noborder" src="../../media/azure-active-directory-users.png" /></p>
<p>We can see that the 25 users were in fact created! The user count has increased by 25, and all the created users are listed.</p>
<p><img alt=" " class="noborder" src="../../media/azure-active-directory-user-list.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you're using an Azure account that you just created for this series of labs, then you'll probably see a total of 26 users: The 25 users that we just created, plus your user account.</p>
<p>If you're using a pre-existing Azure account, then all we can say for certain is that you have 25 more users than you did a few minutes ago!</p>
</div>
</li>
<li>
<p>Let's also check on the applications list.</p>
<p>Navigate to the <strong>App registrations</strong> page, and click on the <strong>All applications</strong> link.</p>
<div class="admonition cmd">
<p class="admonition-title">Search Term</p>
<div class="highlight"><pre><span></span><code>app registrations
</code></pre></div>
</div>
<p><img alt=" " class="noborder" src="../media/azure-app-registrations-all-apps.png" /></p>
<p>We can see that the 7 new applications were in fact created! The application count has increased by 7, and all the created applications are listed.</p>
<p><img alt=" " class="noborder" src="../media/azure-app-registration-list.png" /></p>
<p>All of the newly created applications will have a Display Name that starts with your primary domain name. This is expected, since the Terraform configuration files didn't specify different display name values.</p>
</li>
<li>
<p>Now navigate to the <strong>Enterprise Applications</strong> page.</p>
<p><strong>Click</strong> on the search bar at the top of the page, enter the text 'enterprise applications', and select the <strong>Enterprise Applications</strong> service from the drop-down.</p>
<div class="admonition cmd">
<p class="admonition-title">Search Term</p>
<div class="highlight"><pre><span></span><code>enterprise applications
</code></pre></div>
</div>
<p><img alt=" " class="noborder" src="../media/azure-enterprise-applications.png" /></p>
<p>This page can be used to manage all of applications available to you, including standard existing Microsoft applications.</p>
<p>The list initially has a filter of 'Application type = Enterprise Applications' applied; remove that filter by <strong>clicking</strong> on the 'x' to the right of the filter. Then enter the first part of your primary domain name (for example, 'sansdevstudent') into the search text bar.</p>
<p><img alt=" " class="noborder" src="../media/azure-list-our-applications.png" /></p>
<p>There will be 7 applications listed, all with a name that starts with your primary domain name.</p>
<p><img alt=" " class="noborder" src="../media/azure-our-applications.png" /></p>
<p>These are the service principals created by Terraform, using the configuration files created by PurpleCloud.  These will be used during the next labs to elevate privileges!</p>
</li>
</ol>
<details class="tip">
<summary>Alternate Terraform Commands</summary>
<div class="admonition warning">
<p class="admonition-title">This tip is for informational purposes only. You do <em>not</em> need to execute the commands listed below.</p>
</div>
<p>In this lab step, we ran <code>terraform init</code> to initialize the modules and providers configured in the terraform code, and then <code>terraform apply</code> to to apply the configuration represented by the current directory's <code>*.tf</code> files.</p>
<p>Some Terraform users like to execute an intermediate step, creating a plan file that they can review before applying configuration, or for debugging or troubleshooting purposes. Executing with this intermediate step would use the following commands:</p>
<div class="admonition abstract">
<p class="admonition-title">Alternate Terraform Commands</p>
<div class="highlight"><pre><span></span><code>terraform init
terraform plan -out run.plan
terraform apply run.plan
</code></pre></div>
</div>
</details>
<details class="success">
<summary>Congratulations! You have successfully used the Terraform CLI tool to prepare your test Microsoft Entra ID environment!</summary>
</details>
</details>
<h2 id="conclusion">Conclusion</h2>
<p>In this lab, you used your Azure account to create Azure resources. You used a PurpleCloud script to quickly create Terraform configuration files representing a lab environment, and then used Terraform automation to quickly stand up that lab environment! Exploring your Microsoft Entra ID tenant via the Azure portal, you were able to verify that the environment was stood up correctly.</p>
<details class="tip">
<summary>Using the Azure CLI on Linux</summary>
<p>During this lab, you used the Azure Cloud Shell service to access a bash shell and execute <code>az</code> commands. The Azure CLI is also available on Linux<sup id="fnref:11"><a class="footnote-ref" href="#fn:11">18</a></sup>.</p>
<p>If you were to install the Azure CLI on a Linux system and run the <code>az</code> commands from there, then you could eliminate the need to create an SP-Attack service principal, assign it permissions, and export ARM_* environment variables.</p>
<p>Instead, you could just use the <code>az login</code> command to authenticate with a Global Administrator account. At that point, Terraform would execute its commands in the context of that account.</p>
</details>
<p>In the <a href="../../a3/sec530.bonus.a3/" rel="noopener" target="_blank">next lab</a>, you'll use PowerShell commands to further explore the environment and identify privilege escalation attack primitives that could allow a Tyrell Corp developer to assume excessive privileges.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:18">
<p>Microsoft. (2024, April 29). <em>Azure AD built-in roles: Application Administrator</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#application-administrator" rel="noopener" target="_blank">https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#application-administrator</a>.&#160;<a class="footnote-backref" href="#fnref:18" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:14">
<p>Microsoft. (2024, April 29). <em>Azure AD built-in roles: Privileged Role Administrator</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#privileged-role-administrator" rel="noopener" target="_blank">https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#privileged-role-administrator</a>.&#160;<a class="footnote-backref" href="#fnref:14" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:15">
<p>Microsoft. (2024, March 15). <em>Azure roles, Azure AD roles, and classic subscription administrator roles</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/rbac-and-directory-admin-roles" rel="noopener" target="_blank">https://learn.microsoft.com/en-us/azure/role-based-access-control/rbac-and-directory-admin-roles</a>.&#160;<a class="footnote-backref" href="#fnref:15" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:16">
<p>Microsoft. (2024, April 29). <em>Azure AD built-in roles</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://learn.microsoft.com/en-us/azure/active-directory/roles/permissions-reference" rel="noopener" target="_blank">https://learn.microsoft.com/en-us/azure/active-directory/roles/permissions-reference</a>.&#160;<a class="footnote-backref" href="#fnref:16" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:17">
<p>Microsoft. (2024, April 29). <em>Azure AD built-in roles: Global Administrator</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#global-administrator" rel="noopener" target="_blank">https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#global-administrator</a>.&#160;<a class="footnote-backref" href="#fnref:17" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:13">
<p>Faraglia, Daniele. (2024, May 13; commit db5a5ca9ef1dc9450a2a309945a7faa75007febb). <em>faker</em>. Retrieved May 18, 2024 from <a href="https://github.com/joke2k/faker" rel="noopener" target="_blank">https://github.com/joke2k/faker</a>.&#160;<a class="footnote-backref" href="#fnref:13" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:13" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Ostrom, Jason. (2024, February 18; commit ec010a6a8b0979f2b63e909b3662ce557cc57615). <em>PurpleCloud</em>. Retrieved May 16, 2024 from <a href="https://github.com/iknowjason/PurpleCloud" rel="noopener" target="_blank">https://github.com/iknowjason/PurpleCloud</a>.&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:12">
<p>Ostrom, Jason. (n.d.). <em>Overview</em>. Hybrid + Identity Cyber Range. Retrieved May 16, 2024 from <a href="https://www.purplecloud.network/" rel="noopener" target="_blank">https://www.purplecloud.network/</a>.&#160;<a class="footnote-backref" href="#fnref:12" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn:19">
<p>Microsoft. (n.d.). <em>Azure Command-Line Interface (CLI) documentation</em>. Microsoft Learn. Retrieved May 16, 2024 from <a href="https://learn.microsoft.com/en-us/cli/azure/" rel="noopener" target="_blank">https://learn.microsoft.com/en-us/cli/azure/</a>.&#160;<a class="footnote-backref" href="#fnref:19" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
<li id="fn:20">
<p>Microsoft. (n.d.). <em>Azure Cloud Shell – browser-based Command Line</em>. Microsoft Azure. Retrieved May 16, 2024 from <a href="https://azure.microsoft.com/en-us/get-started/azure-portal/cloud-shell" rel="noopener" target="_blank">https://azure.microsoft.com/en-us/get-started/azure-portal/cloud-shell</a>.&#160;<a class="footnote-backref" href="#fnref:20" title="Jump back to footnote 10 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>Microsoft. (2024, March 7). <em>What is the Azure CLI?</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://learn.microsoft.com/en-us/cli/azure/what-is-azure-cli" rel="noopener" target="_blank">https://learn.microsoft.com/en-us/cli/azure/what-is-azure-cli</a>.&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 11 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>Microsoft. (2024, January 18. <em>How to manage Azure subscriptions with the Azure CLI</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://learn.microsoft.com/en-us/cli/azure/manage-azure-subscriptions-azure-cli" rel="noopener" target="_blank">https://learn.microsoft.com/en-us/cli/azure/manage-azure-subscriptions-azure-cli</a>.&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 12 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>Microsoft. (2024, March 12). <em>What is Azure role-based access control (Azure RBAC)?</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/overview" rel="noopener" target="_blank">https://learn.microsoft.com/en-us/azure/role-based-access-control/overview</a>.&#160;<a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 13 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>Microsoft. (2023, November 28). <em>Add your custom domain name using the Azure portal</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/add-custom-domain" rel="noopener" target="_blank">https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/add-custom-domain</a>.&#160;<a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 14 in the text">&#8617;</a></p>
</li>
<li id="fn:10">
<p>HashiCorp. (n.d.). <em>What is Terraform?</em>. Terraform. Retrieved May 18, 2024 from <a href="https://developer.hashicorp.com/terraform/intro" rel="noopener" target="_blank">https://developer.hashicorp.com/terraform/intro</a>.&#160;<a class="footnote-backref" href="#fnref:10" title="Jump back to footnote 15 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p>HashiCorp. (n.d.). <em>Azure Active Directory Provider</em>. Terraform Registry. Retrieved May 18, 2024 from <a href="https://registry.terraform.io/providers/hashicorp/azuread/latest/docs?ref=dataroots.ghost.io" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azuread/latest/docs?ref=dataroots.ghost.io</a>.&#160;<a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 16 in the text">&#8617;</a></p>
</li>
<li id="fn:9">
<p>Microsoft. (n.d.) <em>Azure Resource Manager</em>. Microsoft Azure. Retrieved May 18, 2024 from <a href="https://azure.microsoft.com/en-us/get-started/azure-portal/resource-manager" rel="noopener" target="_blank">https://azure.microsoft.com/en-us/get-started/azure-portal/resource-manager</a>.&#160;<a class="footnote-backref" href="#fnref:9" title="Jump back to footnote 17 in the text">&#8617;</a></p>
</li>
<li id="fn:11">
<p>Microsoft. (2023, August 8). <em>Install the Azure CLI on Linux</em>. Microsoft Learn. Retrieved May 18, 2024 from <a href="https://learn.microsoft.com/en-us/cli/azure/install-azure-cli-linux?pivots=apt" rel="noopener" target="_blank">https://learn.microsoft.com/en-us/cli/azure/install-azure-cli-linux?pivots=apt</a>.&#160;<a class="footnote-backref" href="#fnref:11" title="Jump back to footnote 18 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../a1/sec530.bonus.a1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Azure Account Setup">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Azure Account Setup
              </div>
            </div>
          </a>
        
        
          
          <a href="../../a3/sec530.bonus.a3/" class="md-footer__link md-footer__link--next" aria-label="Next: Manual Reconnaissance">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Manual Reconnaissance
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ©2024 Greg Scheidel
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "content.code.annotation", "content.code.copy", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.tabs", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5cfa9459.min.js"></script>
      
    
  </body>
</html>